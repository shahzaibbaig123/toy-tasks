// Example program
#include <iostream>
#include <string>
#include <algorithm>
using namespace std;
#include <chrono>
#include <stdio.h>
#include <time.h>


#include <iostream>
#include <fstream>
#include <unistd.h>

void process_mem_usage(double& vm_usage, double& resident_set)
{
    vm_usage     = 0.0;
    resident_set = 0.0;

    // the two fields we want
    unsigned long vsize;
    long rss;
    {
        std::string ignore;
        std::ifstream ifs("/proc/self/stat", std::ios_base::in);
        ifs >> ignore >> ignore >> ignore >> ignore >> ignore >> ignore >> ignore >> ignore >> ignore >> ignore
                >> ignore >> ignore >> ignore >> ignore >> ignore >> ignore >> ignore >> ignore >> ignore >> ignore
                >> ignore >> ignore >> vsize >> rss;
    }

    long page_size_kb = sysconf(_SC_PAGE_SIZE) / 1024; // in case x86-64 is configured to use 2MB pages
    vm_usage = vsize / 1024.0;
    resident_set = rss * page_size_kb;
}

// A comparator function used by qsort
int compare(const void *a, const void *b)
{
    return (*(int *)a - *(int *)b);
}

int main()
{

    clock_t begin, end;
    double time_spent;

    int arr2[] = {18, 347, 418, 854, 880, 961, 714, 66, 809, 850, 871, 110, 936, 304, 157, 399, 763, 857, 825, 356, 320, 793, 296, 788, 429, 398, 240, 174, 119, 716, 641, 419, 852, 333, 736, 303, 607, 900, 557, 70, 751, 605, 117, 916, 186, 873, 803, 506, 438, 702, 615, 36, 290, 942, 975, 354, 740, 210, 432, 872, 183, 466, 248, 8, 109, 491, 494, 532, 62, 841, 47, 952, 647, 57, 406, 994, 3, 424, 570, 674, 765, 222, 24, 374, 509, 159, 553, 359, 233, 843, 847, 545, 562, 154, 638, 542, 696, 60, 311, 5, 732, 634, 602, 383, 593, 939, 100, 989, 160, 611, 859, 15, 867, 478, 193, 224, 971, 606, 712, 370, 272, 878, 703, 0, 128, 822, 368, 624, 321, 785, 107, 133, 332, 443, 164, 963, 670, 768, 126, 104, 297, 242, 185, 421, 479, 237, 292, 572, 918, 804, 376, 957, 505, 430, 861, 125, 906, 644, 393, 247, 122, 931, 26, 280, 196, 295, 381, 56, 717, 743, 635, 589, 707, 998, 940, 902, 65, 129, 371, 760, 759, 152, 29, 53, 927, 617, 917, 141, 904, 457, 12, 471, 811, 48, 423, 276, 268, 599, 909, 84, 658, 135, 341, 165, 445, 490, 472, 315, 495, 691, 312, 413, 262, 469, 965, 81, 95, 774, 643, 464, 323, 202, 23, 171, 949, 61, 797, 762, 97, 597, 780, 960, 147, 753, 818, 121, 849, 795, 215, 510, 948, 713, 649, 563, 382, 55, 465, 386, 613, 79, 7, 192, 271, 340, 718, 416, 246, 440, 195, 730, 594, 560, 322, 544, 94, 460, 734, 661, 699, 944, 102, 403, 378, 454, 497, 552, 962, 285, 698, 88, 775, 256, 671, 204, 750, 136, 127, 35, 907, 663, 470, 283, 184, 786, 686, 801, 345, 566, 480, 83, 11, 756, 327, 966, 766, 417, 473, 541, 684, 530, 442, 221, 511, 585, 810, 64, 879, 87, 990, 481, 286, 31, 108, 892, 206, 344, 149, 269, 402, 214, 360, 502, 507, 431, 452, 17, 1, 608, 834, 548, 680, 487, 889, 409, 567, 735, 816, 855, 459, 98, 277, 25, 414, 77, 501, 508, 890, 692, 145, 574, 749, 676, 328, 694, 19, 236, 821, 289, 294, 273, 410, 591, 203, 260, 139, 365, 805, 461, 648, 189, 307, 579, 620, 229, 614, 659, 213, 51, 45, 49, 299, 705, 455, 728, 96, 846, 218, 434, 640, 80, 253, 148, 500, 650, 168, 729, 249, 757, 388, 828, 493, 513, 357, 317, 979, 175, 829, 298, 886, 746, 367, 561, 782, 976, 835, 331, 571, 391, 198, 578, 42, 779, 584, 667, 433, 922, 543, 263, 610, 305, 324, 63, 842, 885, 228, 758, 458, 883, 264, 945, 106, 309, 456, 787, 287, 58, 770, 968, 72, 827, 377, 664, 554, 995, 99, 564, 985, 993, 946, 898, 708, 13, 498, 369, 645, 90, 547, 988, 704, 881, 986, 216, 546, 252, 21, 688, 373, 261, 987, 270, 392, 894, 812, 282, 595, 868, 441, 813, 556, 678, 244, 16, 991, 524, 143, 921, 796, 115, 156, 279, 351, 274, 823, 302, 711, 116, 124, 518, 764, 992, 339, 619, 405, 231, 618, 723, 91, 800, 848, 420, 807, 257, 913, 499, 343, 394, 587, 349, 802, 875, 672, 20, 220, 660, 105, 123, 142, 596, 407, 956, 910, 435, 439, 893, 337, 226, 687, 679, 622, 255, 844, 350, 629, 926, 915, 924, 425, 896, 85, 980, 197, 884, 745, 761, 92, 444, 864, 412, 516, 52, 527, 211, 582, 188, 837, 697, 75, 824, 144, 531, 449, 446, 715, 778, 301, 601, 941, 853, 520, 653, 212, 486, 600, 316, 427, 951, 689, 625, 970, 935, 604, 943, 521, 330, 997, 932, 239, 146, 833, 355, 284, 199, 113, 353, 577, 38, 118, 534, 519, 390, 40, 319, 234, 832, 551, 612, 869, 652, 209, 111, 719, 642, 140, 792, 903, 278, 170, 747, 891, 540, 397, 338, 396, 568, 474, 227, 358, 514, 238, 609, 201, 666, 158, 225, 863, 389, 483, 637, 929, 342, 180, 630, 656, 683, 700, 41, 748, 887, 794, 851, 737, 266, 101, 219, 920, 808, 923, 983, 39, 819, 492, 662, 153, 512, 838, 633, 326, 781, 791, 727, 668, 739, 731, 130, 969, 131, 468, 720, 573, 463, 54, 632, 755, 973, 2, 911, 59, 379, 477, 485, 581, 733, 384, 646, 912, 627, 4, 489, 690, 43, 401, 651, 138, 831, 603, 526, 265, 30, 462, 451, 408, 385, 626, 996, 538, 44, 773, 447, 583, 132, 860, 484, 535, 623, 654, 37, 710, 415, 161, 856, 769, 10, 845, 93, 744, 639, 706, 28, 293, 953, 488, 150, 752, 772, 167, 281, 362, 669, 33, 250, 67, 314, 450, 789, 533, 901, 978, 722, 677, 86, 243, 876, 815, 515, 205, 817, 73, 984, 865, 275, 701, 169, 777, 899, 790, 166, 981, 208, 50, 27, 938, 453, 569, 217, 387, 576, 361, 223, 858, 905, 335, 598, 958, 682, 245, 967, 525, 482, 709, 919, 954, 112, 191, 313, 685, 558, 34, 308, 950, 194, 741, 179, 318, 200, 254, 364, 288, 181, 428, 306, 866, 346, 411, 726, 550, 947, 71, 742, 162, 830, 504, 754, 137, 177, 964, 182, 76, 771, 74, 590, 230, 267, 974, 363, 839, 476, 588, 982, 103, 655, 251, 395, 725, 336, 897, 437, 78, 628, 291, 673, 436, 665, 503, 862, 536, 207, 89, 258, 657, 783, 874, 928, 528, 555, 22, 14, 426, 586, 934, 176, 999, 972, 178, 32, 888, 621, 155, 134, 776, 738, 930, 422, 496, 400, 163, 523, 187, 6, 895, 882, 616, 580, 366, 559, 172, 933, 836, 329, 380, 68, 448, 467, 840, 549, 695, 937, 404, 631, 575, 675, 767, 348, 806, 877, 190, 539, 241, 235, 375, 914, 310, 870, 232, 529, 9, 537, 114, 300, 814, 517, 798, 724, 120, 977, 959, 925, 681, 784, 82, 522, 636, 325, 955, 565, 334, 693, 799, 475, 908, 352, 592, 173, 820, 259, 151, 826, 69, 46, 372, 721};

    int n = sizeof(arr2) / sizeof(arr2[0]);


    time_spent = 0.0;
    begin = clock();
    qsort(arr2, 1000, sizeof(int), compare); 
    end = clock();

    double vm, rss;
   process_mem_usage(vm, rss);
   cout << "VM: " << vm << "; RSS: " << rss << endl;

    // calculate time taken by C++ sort
    time_spent = (double)(end - begin) / CLOCKS_PER_SEC;

    cout << "Time taken by C++ qsort() - "
         << time_spent << endl;

    //   auto end = std::chrono::steady_clock::now();
    //   std::chrono::duration<double> elapsed_seconds = end-start;
    //   std::cout << "elapsed time: " << elapsed_seconds.count() << "s\n";

    //   cout << "\nArray after sorting using "
    //             "default sort is : \n";
    //   for (int i = 0; i < n; ++i)
    //     cout << arr[i] << " ";

    return 0;
}
